clc; close all;
%taustar = [0.2,0.25,0.3,0.35,0.37,0.4,0.42,0.43,0.44,0.45,0.47,0.48,0.5,0.53,0.55,0.57,0.6,0.63,0.65,0.7];
taustar = [0.2,0.3,0.35,0.4,0.45,0.47,0.5,0.55,0.6,0.63,0.65,0.7];

alpha = 0.01;
F = [];
tau = [];
for i=1:length(taustar)
    i
    [Fopt,tauopt] = LP(alpha,taustar(i));
    F(i) = Fopt;
    tau(i) = tauopt;
end
%{
for i=1:25
    taustar = 0.2 + 0.02 * i;
    [Fopt,tauopt] = LP(alpha,taustar);
    F(i) = Fopt;
    tau(i) = tauopt;
end
%}
F
tau
Fbefore = [0.012844164240602,0.482660459436669,1.827538453567954,2.188561500676742,2.367965833004328, 2.507710267847965, 2.691354921617603,2.91090444,3.014781732302924,3.222552379584075,3.841410682644145,4.522381305480149,5.772779837393085,6.996201482556237];
taubefore = [0.155199891639799,0.217281717251963,0.376433201620960,0.413024447887163,0.430111256894776,0.442869353431163, 0.460306225899209,0.480339572647356,0.488505152102054,0.504892639883588,0.553046476235961, 0.600228724866370,0.669778352594887,0.733983504882256];
plot(tau,F,'-r');
plot(taubefore,Fbefore,'-')
legend('Without trust region adjusting','With trust region')